# Shared tasks for React + Vite application packages
# https://moonrepo.dev/docs/config/tasks
# yaml-language-server: $schema=https://moonrepo.dev/schemas/tasks.json

$schema: https://moonrepo.dev/schemas/tasks.json

extends: "./typescript-library.yml"

fileGroups:
  sources:
    - "src/**/*"
  public:
    - "public/**/*"

tasks:
  # Build React app with Vite
  build:
    command:
      - "npm"
      - "run"
      - "build"
    inputs:
      - "@globs(sources)"
      - "@globs(public)"
      - "index.html"
      - "tsconfig*.json"
      - "vite.config.*"
    outputs:
      - "dist"
    options:
      cache: true
      runDepsInParallel: true

  # Development server with Vite
  dev:
    command:
      - "npm"
      - "run"
      - "dev"
    local: true
    options:
      cache: false
      runInCI: false
      persistent: true

  # Preview production build locally
  preview:
    command:
      - "npm"
      - "run"
      - "preview"
    local: true
    options:
      cache: false
      runInCI: false
      persistent: true
